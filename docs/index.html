<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="A ggplot2 based implementation of biplots, giving a representation of a dataset in
    a two dimensional space accounting for the greatest variance, together with variable vectors
    showing how the data variables relate to this space. It provides a 
    replacement for stats::biplot(), but with many enhancements to control the analysis and
    graphical display. It implements 
    biplot and scree plot methods using ggplot2 which can be used with the results of prcomp(), princomp(),
    FactoMineR::PCA() or MASS::lda() and can be customized using ggplot2 techniques.">
<title>A ggplot2 Based Implementation of Biplots • ggbiplot</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/Roboto-0.4.8/font.css" rel="stylesheet">
<link href="deps/JetBrains_Mono-0.4.8/font.css" rel="stylesheet">
<link href="deps/Roboto_Slab-0.4.8/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="A ggplot2 Based Implementation of Biplots">
<meta property="og:description" content="A ggplot2 based implementation of biplots, giving a representation of a dataset in
    a two dimensional space accounting for the greatest variance, together with variable vectors
    showing how the data variables relate to this space. It provides a 
    replacement for stats::biplot(), but with many enhancements to control the analysis and
    graphical display. It implements 
    biplot and scree plot methods using ggplot2 which can be used with the results of prcomp(), princomp(),
    FactoMineR::PCA() or MASS::lda() and can be customized using ggplot2 techniques.">
<meta property="og:image" content="http://friendly.github.io/ggbiplot/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">ggbiplot</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/friendly/ggbiplot/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9">
<p>This repo for the <strong>ggbiplot</strong> package <!-- [ggbiplot package](https://CRAN.R-project.org/package=ggbiplot) --> was forked from <a href="https://github.com/vqv/ggbiplot" class="external-link uri">https://github.com/vqv/ggbiplot</a> by Vince Yu, which has been dormant since 2015.</p>
<p>The goal is to complete that development and publish a new version on CRAN with Vince Yu as the principal author. There is also an <a href="https://github.com/friendly/ggbiplot/tree/experimental" class="external-link">experimental branch</a> which attempts to simplify the code, but this has some unresolved problems.</p>
<div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="ggbiplot-">ggbiplot <a class="anchor" aria-label="anchor" href="#ggbiplot-"></a>
</h1>
</div>
<p>This package provides a <code>ggplot2</code> implementation of the biplot, a simultaneous plot of scores for observations and vectors for variables for principal component-like analyses.<br>
The package provides two main functions: <code><a href="reference/ggscreeplot.html">ggscreeplot()</a></code> and <code><a href="reference/ggbiplot.html">ggbiplot()</a></code>.</p>
<p><code>ggbiplot</code> aims to be a drop-in replacement for the built-in R function <code>biplot.princomp()</code> with extended functionality for labeling groups, drawing a correlation circle, and adding data ellipsoids.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Install the current master branch with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"friendly/ggbiplot"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p>Load packages:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/friendly/ggbiplot" class="external-link">ggbiplot</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/taiyun/corrplot" class="external-link">corrplot</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># set ggplot2 theme</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="crime-data">Crime data<a class="anchor" aria-label="anchor" href="#crime-data"></a>
</h3>
<p>The <code>crime</code> data gives rates of various serious crimes in each of the 50 U. S. states, originally from the United States Statistical Abstracts (1970).</p>
<p>Let’s take a quick look at the correlations among these, using <code><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html" class="external-link">corrplot::corrplot()</a></code> and showing each correlation by an ellipse whose eccentricity and shading represents the value of the correlation.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">crime</span><span class="op">)</span></span>
<span><span class="va">crime</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html" class="external-link">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html" class="external-link">corrplot</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"ellipse"</span>, tl.srt <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-crime-corrplot-1.png"><!-- --></p>
<p>The correlations are all positive. Note also that the variables in the dataset are ordered in seriousness or violence, ranging from murder to auto theft.</p>
<p>Carry out a PCA:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">crime.pca</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">crime</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html" class="external-link">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp</a></span><span class="op">(</span>scale. <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">crime.pca</span></span>
<span><span class="co">#&gt; Standard deviations (1, .., p=7):</span></span>
<span><span class="co">#&gt; [1] 2.029 1.113 0.852 0.563 0.508 0.471 0.352</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rotation (n x k) = (7 x 7):</span></span>
<span><span class="co">#&gt;             PC1     PC2     PC3     PC4     PC5     PC6     PC7</span></span>
<span><span class="co">#&gt; murder   -0.300 -0.6292  0.1782 -0.2321  0.5381  0.2591  0.2676</span></span>
<span><span class="co">#&gt; rape     -0.432 -0.1694 -0.2442  0.0622  0.1885 -0.7733 -0.2965</span></span>
<span><span class="co">#&gt; robbery  -0.397  0.0422  0.4959 -0.5580 -0.5200 -0.1144 -0.0039</span></span>
<span><span class="co">#&gt; assault  -0.397 -0.3435 -0.0695  0.6298 -0.5067  0.1724  0.1917</span></span>
<span><span class="co">#&gt; burglary -0.440  0.2033 -0.2099 -0.0576  0.1010  0.5360 -0.6481</span></span>
<span><span class="co">#&gt; larceny  -0.357  0.4023 -0.5392 -0.2349  0.0301  0.0394  0.6017</span></span>
<span><span class="co">#&gt; auto     -0.295  0.5024  0.5684  0.4192  0.3698 -0.0573  0.1470</span></span></code></pre></div>
<p>The biplot, using default scaling (standardized components), and labeling the states by their state abbreviation:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/ggbiplot.html">ggbiplot</a></span><span class="op">(</span><span class="va">crime.pca</span>,</span>
<span>         labels <span class="op">=</span> <span class="va">crime</span><span class="op">$</span><span class="va">st</span> ,</span>
<span>         circle <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>         varname.size <span class="op">=</span> <span class="fl">4</span>,</span>
<span>         varname.color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> </span></code></pre></div>
<p><img src="reference/figures/README-crime-biplot0-1.png"><!-- --></p>
<p>The directions of the principal components are arbitrary; we are free to reflect the variable vectors and component scores to facilitate interpretation. Also, there seem to be differences among regions of the U.S., which can be visualized using data ellipses for the component scores. The <code>groups</code> argument allows the observations to colored by group and to summarized by groups.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">crime.pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/reflect.html">reflect</a></span><span class="op">(</span><span class="va">crime.pca</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/ggbiplot.html">ggbiplot</a></span><span class="op">(</span><span class="va">crime.pca</span>,</span>
<span>         groups <span class="op">=</span> <span class="va">crime</span><span class="op">$</span><span class="va">region</span>,</span>
<span>         labels <span class="op">=</span> <span class="va">crime</span><span class="op">$</span><span class="va">st</span>,</span>
<span>         labels.size <span class="op">=</span> <span class="fl">4</span>,</span>
<span>         var.factor <span class="op">=</span> <span class="fl">1.4</span>,</span>
<span>         ellipse <span class="op">=</span> <span class="cn">TRUE</span>, ellipse.level <span class="op">=</span> <span class="fl">0.5</span>, ellipse.alpha <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>         circle <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>         varname.size <span class="op">=</span> <span class="fl">4</span>,</span>
<span>         varname.color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Region"</span>, color <span class="op">=</span> <span class="st">"Region"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.direction <span class="op">=</span> <span class="st">'horizontal'</span>, legend.position <span class="op">=</span> <span class="st">'top'</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-crime-biplot1-1.png"><!-- --></p>
<p>The interpretation of the data is now clear.</p>
<ul>
<li><p>The first dimension, accounting for 58.8% of variance, can be seen to represent <strong>overall crime rate</strong>, with Nevada (NV) at the high end and North Dakota (ND), South Dakota (SD) and West Virginia (WV) at the low end.</p></li>
<li><p>The second dimension, accounting for 17.7% of variance represents a contrast between <strong>personal crime vs. property crime</strong>. On this dimension, Massachusetts (MA), Rhode Island (RI) are opposed to Mississippi (MS), Alabama (AL), Louisiana (LA) and South Carolina (SC).</p></li>
<li><p>The regions are represented by the differences in the centers of the data ellipses for the scores. Southern states are highest on murder, assault and rape, while the Northeast states are highest on auto theft and larceny.</p></li>
<li><p>In this standardized view, the angles between variable vectors approximate the correlations among the variables, according to <span class="math inline">cos (angle) ≈ <em>r</em></span>. Thus, <code>murder</code> and <code>auto</code>, nearly <span class="math inline">90<sup><em>o</em></sup></span> reflect a near 0 correlation.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="wine-data">Wine data<a class="anchor" aria-label="anchor" href="#wine-data"></a>
</h3>
<p>The <code>wine</code> data contains results of a chemical analysis of wines grown in the same region in Italy, derived from three different cultivars. The analysis determined the quantities of 13 chemical constituents found in each of the three types of wines. The grape varieties (cultivars), <strong>barolo</strong>, <strong>barbera</strong>, and <strong>grignolino</strong>, are given in <code>wine.class</code>.</p>
<p>What can we understand about the differences among these wines from a biplot?</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/friendly/ggbiplot" class="external-link">ggbiplot</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">wine</span><span class="op">)</span></span>
<span><span class="va">wine.pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp</a></span><span class="op">(</span><span class="va">wine</span>, scale. <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/ggscreeplot.html">ggscreeplot</a></span><span class="op">(</span><span class="va">wine.pca</span><span class="op">)</span> </span></code></pre></div>
<p><img src="reference/figures/README-wine-screeplot-1.png"><!-- --></p>
<p>Hmm. The screeplot shows that more than two dimensions are necessary to account for most of the variance.</p>
<p>Plot the first two PCA dimensions, accounting for 55% of the variance.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/ggbiplot.html">ggbiplot</a></span><span class="op">(</span><span class="va">wine.pca</span>, </span>
<span>  obs.scale <span class="op">=</span> <span class="fl">1</span>, var.scale <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  groups <span class="op">=</span> <span class="va">wine.class</span>, </span>
<span>  varname.size <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  ellipse <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>  circle <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Cultivar"</span>, color <span class="op">=</span> <span class="st">"Cultivar"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.direction <span class="op">=</span> <span class="st">'horizontal'</span>, legend.position <span class="op">=</span> <span class="st">'top'</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-wine-biplot-1.png"><!-- --></p>
<p>The three cultivars are arranged along the first dimension, in the order barolo &lt; grignolino &lt; barbera. These are distinguished largely by a contrast between (<code>Phenols</code>, <code>Flav</code>) vs. (<code>NonFlavPhenols</code>, <code>AlcAsh</code>). The second dimension is represented by the cluster of variables <code>Mg</code>, <code>Alcohol</code>, <code>Ash</code>, <code>Color</code>, which distinguishes grignolino from the other two.</p>
</div>
<div class="section level3">
<h3 id="iris-data">Iris data<a class="anchor" aria-label="anchor" href="#iris-data"></a>
</h3>
<p>The classic iris data is widely used for examples of multivariate analysis and biplots, so let’s use it here.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="va">iris.pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp</a></span> <span class="op">(</span><span class="op">~</span> <span class="va">Sepal.Length</span> <span class="op">+</span> <span class="va">Sepal.Width</span> <span class="op">+</span> <span class="va">Petal.Length</span> <span class="op">+</span> <span class="va">Petal.Width</span>,</span>
<span>                    data<span class="op">=</span><span class="va">iris</span>,</span>
<span>                    scale. <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">iris.pca</span><span class="op">)</span></span>
<span><span class="co">#&gt; Importance of components:</span></span>
<span><span class="co">#&gt;                         PC1   PC2    PC3     PC4</span></span>
<span><span class="co">#&gt; Standard deviation     1.71 0.956 0.3831 0.14393</span></span>
<span><span class="co">#&gt; Proportion of Variance 0.73 0.229 0.0367 0.00518</span></span>
<span><span class="co">#&gt; Cumulative Proportion  0.73 0.958 0.9948 1.00000</span></span></code></pre></div>
<p>Plot the first two dimensions:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris.gg</span> <span class="op">&lt;-</span></span>
<span><span class="fu"><a href="reference/ggbiplot.html">ggbiplot</a></span><span class="op">(</span><span class="va">iris.pca</span>, obs.scale <span class="op">=</span> <span class="fl">1</span>, var.scale <span class="op">=</span> <span class="fl">1</span>,</span>
<span>         groups <span class="op">=</span> <span class="va">iris</span><span class="op">$</span><span class="va">Species</span>, point.size<span class="op">=</span><span class="fl">2</span>,</span>
<span>         varname.size <span class="op">=</span> <span class="fl">5</span>, </span>
<span>         varname.color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>         varname.adjust <span class="op">=</span> <span class="fl">1.2</span>,</span>
<span>         ellipse <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>         circle <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Species"</span>, color <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.direction <span class="op">=</span> <span class="st">'horizontal'</span>, legend.position <span class="op">=</span> <span class="st">'top'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">iris.gg</span></span></code></pre></div>
<p><img src="reference/figures/README-iris-biplot0-1.png"><!-- --></p>
<p>It is possible to add annotations to the biplot by making use of the fact that <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot()</a></code> returns a lot of information in the <code>"gg"</code> object. In particular, the <code>$data</code> component contains the scores on the principal components that are plotted as points here. Here we add direct labels for the groups and suppress the legend.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get means of coordinates by group</span></span>
<span><span class="va">group.labs</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">iris.gg</span><span class="op">$</span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>xvar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">xvar</span><span class="op">)</span>,</span>
<span>            yvar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">yvar</span><span class="op">)</span>, .by <span class="op">=</span> <span class="va">groups</span><span class="op">)</span></span>
<span></span>
<span><span class="va">group.labs</span></span>
<span><span class="co">#&gt;       groups   xvar   yvar</span></span>
<span><span class="co">#&gt; 1     setosa -2.217 -0.288</span></span>
<span><span class="co">#&gt; 2 versicolor  0.495  0.548</span></span>
<span><span class="co">#&gt; 3  virginica  1.723 -0.260</span></span></code></pre></div>
<p>Now, just use <code>geom_label</code> to draw labels for the groups.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris.gg</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_label</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">group.labs</span>,</span>
<span>                     <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">xvar</span>, y<span class="op">=</span><span class="va">yvar</span>, label<span class="op">=</span><span class="va">groups</span><span class="op">)</span>,</span>
<span>                     size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-iris-biplot1-1.png"><!-- --></p>
</div>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/friendly/ggbiplot/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/friendly/ggbiplot/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-2" class="external-link">GPL-2</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing ggbiplot</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Vincent Vu <br><small class="roles"> Author </small>  </li>
<li>Michael Friendly <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-3237-0941" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://CRAN.R-project.org/package=ggbiplot" class="external-link"><img src="https://www.r-pkg.org/badges/version/ggbiplot" alt="CRAN status"></a></li>
<li><a href="https://github.com/friendly/ggbiplot" class="external-link"><img src="https://img.shields.io/github/last-commit/friendly/ggbiplot" alt="Last Commit"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Vincent Vu, Michael Friendly.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
